(window.webpackJsonp=window.webpackJsonp||[]).push([[3],{106:function(e,t,n){"use strict";n.r(t);var i=n(6),o=(n(24),n(60)),s=n.n(o),a=n(43),r=n(16),d=n(5),h=n(21),c=n(7),l=n(13),p=n(15),u=n(17);class y extends a.a{constructor(e,t){super(e,t),this.physics.player1.isComputer=!1,this.physics.player2.isComputer=!1,this.keyboardArray[0].unsubscribe(),this.keyboardArray[1].unsubscribe(),this.myKeyboard=r.d,this.myOnlineKeyboard=new r.a(this.myKeyboard.inputQueue),this.peerOnlineKeyboard=new r.a(d.b.peerInputQueue),this._amIPlayer2=!1,this.keyboardArray=[this.myOnlineKeyboard,this.peerOnlineKeyboard],this._syncCounter=0,this.noInputFrameTotal.menu=1/0,this.isFirstGame=!0,this.willSaveReplay=!0}get amIPlayer2(){return this._amIPlayer2}set amIPlayer2(e){this._amIPlayer2=e,d.b.amIPlayer2=e,!0===this._amIPlayer2?this.keyboardArray=[this.peerOnlineKeyboard,this.myOnlineKeyboard]:this.keyboardArray=[this.myOnlineKeyboard,this.peerOnlineKeyboard]}get syncCounter(){return this._syncCounter}set syncCounter(e){this._syncCounter=Object(h.b)(e,d.a)}intro(){0===this.frameCounter&&(this.selectedWithWho=0,this.isFirstGame?(this.isFirstGame=!1,this.amIPlayer2=!d.b.amICreatedRoom):d.b.isQuickMatch&&Object(c.c)()),super.intro()}menu(){const e=this.selectedWithWho;super.menu(),this.selectedWithWho!==e&&(this.amIPlayer2=!this.amIPlayer2,Object(l.a)(d.b.myNickname,this.amIPlayer2),Object(l.a)(d.b.peerNickname,!this.amIPlayer2),Object(l.b)(d.b.myPartialPublicIP,this.amIPlayer2),Object(l.b)(d.b.peerPartialPublicIP,!this.amIPlayer2))}gameLoop(){d.b.gameStartAllowed&&d.b.isOpen&&(this.myKeyboard.getInputIfNeededAndSendToPeer(this.syncCounter),this.gameLoopFromGettingPeerInput())}gameLoopFromGettingPeerInput(){if(!this.peerOnlineKeyboard.isInputOnQueue(this.syncCounter))return void(d.b.callbackAfterPeerInputQueueReceived=this.gameLoopFromGettingPeerInput.bind(this));if(this.myOnlineKeyboard.isInputOnQueue(this.syncCounter)){if(this.peerOnlineKeyboard.getInput(this.syncCounter),this.myOnlineKeyboard.getInput(this.syncCounter),this.syncCounter++,this.willSaveReplay){const e=new u.b;e.xDirection=this.keyboardArray[0].xDirection,e.yDirection=this.keyboardArray[0].yDirection,e.powerHit=this.keyboardArray[0].powerHit;const t=new u.b;t.xDirection=this.keyboardArray[1].xDirection,t.yDirection=this.keyboardArray[1].yDirection,t.powerHit=this.keyboardArray[1].powerHit,p.a.recordInputs(e,t)}if(this.slowMotionFramesLeft>0){if(this.slowMotionNumOfSkippedFrames++,this.slowMotionNumOfSkippedFrames%Math.round(this.normalFPS/this.slowMotionFPS)!=0)return;this.slowMotionFramesLeft--,this.slowMotionNumOfSkippedFrames=0}this.physics.player1.isComputer=!1,this.physics.player2.isComputer=!1,this.state(),this.peerOnlineKeyboard.inputQueue.length>r.c&&(this.myOnlineKeyboard.inputQueue.length>r.c?window.setTimeout(this.gameLoopFromGettingPeerInput.bind(this),0):window.setTimeout(this.gameLoop.bind(this),0))}}}var w=n(9),m=n(41),b=n(11);const f=["KeyR","KeyF","KeyD","KeyG"];class g extends i.Container{constructor(){super()}init(){const e=new i.Graphics;e.beginFill(863809),e.drawRect(0,0,480,800),this.addChild(e);const t=new i.TextStyle({fontFamily:"game-boy",fontSize:200,fontStyle:"",fill:["#44AD9F"],wordWrap:!0,wordWrapWidth:440}),n=new i.TextStyle({fontFamily:"game-boy",fontSize:90,fontStyle:"",fill:["#44AD9F"],wordWrap:!0,wordWrapWidth:440}),o=new i.Container;o.x=120,o.y=150,this.addChild(o);const s=[!1,!1,!1,!1],a=[!1,!1,!1,!1];let r="S",d=!1;const h=new i.Sprite(i.Texture.EMPTY);h.anchor.x=.5,h.anchor.y=.5,h.x=0,h.y=0,h.width=180,h.height=220,h.buttonMode=!0,h.interactive=!0,h.on("pointermove",e=>{console.log("pointermove"),d&&(l(e),u())}),h.on("pointerdown",e=>{console.log("pointerdown"),d=!0,c(),l(e),u()}),h.on("pointerup",()=>{console.log("pointerup"),d=!1,p(),u()}),h.on("pointerupoutside",()=>{console.log("pointerupoutside"),d=!1,p(),u()}),o.addChild(h);const c=()=>{for(let e=0;e<s.length;e++)s[e]=!1,a[e]=!1},l=e=>{const{x:t,y:n}=e.data.getLocalPosition(o),i=Math.hypot(t,n);if(i<20)return;if(i>90)return;for(let e=0;e<a.length;e++)a[e]=!1;const d=-1*t+0*n,h=0*t- -1*n,c=180*Math.atan2(h,d)/Math.PI+180;c<15||c>345?(console.log("→"),a[3]=!0,r="D"):c>=15&&c<=75?(console.log("↗︎"),a[0]=!0,a[3]=!0,r="E"):c>75&&c<105?(console.log("↑"),a[0]=!0,r="W"):c>=105&&c<165?(console.log("↖︎"),a[0]=!0,a[2]=!0,r="Q"):c>165&&c<195?(console.log("←"),a[2]=!0,r="A"):c>=195&&c<=255?(console.log("↙︎"),a[1]=!0,a[2]=!0,r="Z"):c>255&&c<285?(console.log("↓"),a[1]=!0,r="X"):c>=285&&c<=345&&(console.log("↘︎"),a[1]=!0,a[3]=!0,r="C");for(let e=0;e<s.length;e++)a[e]&&!s[e]?window.dispatchEvent(new KeyboardEvent("keydown",{code:f[e]})):!a[e]&&s[e]&&window.dispatchEvent(new KeyboardEvent("keyup",{code:f[e]})),s[e]=a[e]},p=()=>{for(let e=0;e<s.length;e++)s[e]&&window.dispatchEvent(new KeyboardEvent("keyup",{code:f[e]}));r="S"},u=()=>{y.text=r},y=new i.Text("S",t);y.anchor.x=.5,y.anchor.y=.5,y.x=0,y.y=-7,o.addChild(y);const w=new i.Text("a",n);w.anchor.x=.5,w.anchor.y=.5,w.x=290,w.y=200,w.buttonMode=!0,w.interactive=!0,w.on("pointerdown",e=>{window.dispatchEvent(new KeyboardEvent("keydown",{code:"KeyZ"})),e.target.scale.x=1.2,e.target.scale.y=1.2,e.target.text="<"}),w.on("pointerup",e=>{window.dispatchEvent(new KeyboardEvent("keyup",{code:"KeyZ"})),e.target.scale.x=1,e.target.scale.y=1,e.target.text="a"}),w.on("pointerupoutside",()=>{window.dispatchEvent(new KeyboardEvent("keyup",{code:"KeyZ"})),w.scale.x=1,w.scale.y=1,w.text="b"}),this.addChild(w);const m=new i.Text("b",n);m.anchor.x=.5,m.anchor.y=.5,m.x=400,m.y=150,m.buttonMode=!0,m.interactive=!0,m.on("pointerdown",e=>{window.dispatchEvent(new KeyboardEvent("keydown",{code:"KeyZ"})),e.target.scale.x=1.2,e.target.scale.y=1.2,e.target.text=">"}),m.on("pointerup",e=>{window.dispatchEvent(new KeyboardEvent("keyup",{code:"KeyZ"})),e.target.scale.x=1,e.target.scale.y=1,e.target.text="b"}),m.on("pointerupoutside",()=>{window.dispatchEvent(new KeyboardEvent("keyup",{code:"KeyZ"})),m.scale.x=1,m.scale.y=1,m.text="b"}),this.addChild(m)}}n(37);window.PIXI=i;const v=w.a.TEXTURES;v.WITH_COMPUTER=v.WITH_FRIEND;const x=i.settings;x.RESOLUTION=window.devicePixelRatio,x.SCALE_MODE=i.SCALE_MODES.NEAREST,x.ROUND_PIXELS=!0;const E=i.autoDetectRenderer({width:window.innerWidth,height:window.innerHeight,antialias:!1,backgroundColor:0,transparent:!1,resolution:1}),C=new i.Container,I=new i.Ticker,P=new i.Loader,k=new s.a("game-boy");document.querySelector("#game-canvas-container").appendChild(E.view);const O=new g,S=new class{constructor(e,t,n){this.renderer=e,this.view=new i.Container,this.initApp(),this.stage=t,this.initStage(),this.view.addChild(this.stage),this.gamepad=n,this.initGamepad(),this.view.addChild(this.gamepad),window.appView=this.view}initStage(){const e=new i.Graphics;e.beginFill(0),e.drawRect(0,0,432,304),this.stage.addChild(e);this.stage.scale.x=480/432,this.stage.scale.y=480/432}initGamepad(){this.gamepad.x=0,this.gamepad.y=this.stage.height}initApp(){const e=new i.Graphics;if(e.beginFill(0),e.drawRect(0,0,480,800),this.view.addChild(e),this.renderer.width>this.renderer.height){const e=this.renderer.height/800;this.view.scale.x=e,this.view.scale.y=e,this.view.x=this.renderer.width/2-this.view.width/2,this.view.y=0,this.mask=new i.Graphics,this.mask.beginFill(16777215),this.mask.drawRect(this.view.x,this.view.y,this.view.width,this.view.height),this.view.mask=this.mask}else this.view.height=800*this.renderer.width/480,this.view.width=this.renderer.width}}(E,C,O);E.render(S.view),P.add(w.a.SPRITE_SHEET);for(const e in w.a.SOUNDS)P.add(w.a.SOUNDS[e]);function K(){const e=new y(C,P.resources);Object(c.B)(e,I),Object(b.g)(e),function(e){I.maxFPS=e.normalFPS,I.add(()=>{E.render(S.view),e.gameLoop()}),I.start()}(e)}!function(){const e=document.getElementById("loading-box"),t=document.getElementById("progress-bar");P.onProgress.add(()=>{t.style.width=P.progress+"%"}),P.onComplete.add(()=>{e.classList.contains("hidden")||e.classList.add("hidden")})}(),d.b.callbackAfterDataChannelOpened=()=>{k.load().then(()=>O.init()).then(()=>P.load(K))},Object(c.A)(),Object(m.b)()},60:function(e,t,n){!function(){function t(e,t){document.addEventListener?e.addEventListener("scroll",t,!1):e.attachEvent("scroll",t)}function n(e){this.a=document.createElement("div"),this.a.setAttribute("aria-hidden","true"),this.a.appendChild(document.createTextNode(e)),this.b=document.createElement("span"),this.c=document.createElement("span"),this.h=document.createElement("span"),this.f=document.createElement("span"),this.g=-1,this.b.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;",this.c.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;",this.f.style.cssText="max-width:none;display:inline-block;position:absolute;height:100%;width:100%;overflow:scroll;font-size:16px;",this.h.style.cssText="display:inline-block;width:200%;height:200%;font-size:16px;max-width:none;",this.b.appendChild(this.h),this.c.appendChild(this.f),this.a.appendChild(this.b),this.a.appendChild(this.c)}function i(e,t){e.a.style.cssText="max-width:none;min-width:20px;min-height:20px;display:inline-block;overflow:hidden;position:absolute;width:auto;margin:0;padding:0;top:-999px;white-space:nowrap;font-synthesis:none;font:"+t+";"}function o(e){var t=e.a.offsetWidth,n=t+100;return e.f.style.width=n+"px",e.c.scrollLeft=n,e.b.scrollLeft=e.b.scrollWidth+100,e.g!==t&&(e.g=t,!0)}function s(e,n){function i(){var e=s;o(e)&&e.a.parentNode&&n(e.g)}var s=e;t(e.b,i),t(e.c,i),o(e)}function a(e,t){var n=t||{};this.family=e,this.style=n.style||"normal",this.weight=n.weight||"normal",this.stretch=n.stretch||"normal"}var r=null,d=null,h=null,c=null;function l(){return null===c&&(c=!!document.fonts),c}function p(){if(null===h){var e=document.createElement("div");try{e.style.font="condensed 100px sans-serif"}catch(e){}h=""!==e.style.font}return h}function u(e,t){return[e.style,e.weight,p()?e.stretch:"","100px",t].join(" ")}a.prototype.load=function(e,t){var o=this,a=e||"BESbswy",h=0,c=t||3e3,p=(new Date).getTime();return new Promise((function(e,t){if(l()&&!function(){if(null===d)if(l()&&/Apple/.test(window.navigator.vendor)){var e=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))(?:\.([0-9]+))/.exec(window.navigator.userAgent);d=!!e&&603>parseInt(e[1],10)}else d=!1;return d}()){var y=new Promise((function(e,t){!function n(){(new Date).getTime()-p>=c?t(Error(c+"ms timeout exceeded")):document.fonts.load(u(o,'"'+o.family+'"'),a).then((function(t){1<=t.length?e():setTimeout(n,25)}),t)}()})),w=new Promise((function(e,t){h=setTimeout((function(){t(Error(c+"ms timeout exceeded"))}),c)}));Promise.race([w,y]).then((function(){clearTimeout(h),e(o)}),t)}else!function(e){document.body?e():document.addEventListener?document.addEventListener("DOMContentLoaded",(function t(){document.removeEventListener("DOMContentLoaded",t),e()})):document.attachEvent("onreadystatechange",(function t(){"interactive"!=document.readyState&&"complete"!=document.readyState||(document.detachEvent("onreadystatechange",t),e())}))}((function(){function d(){var t;(t=-1!=m&&-1!=b||-1!=m&&-1!=f||-1!=b&&-1!=f)&&((t=m!=b&&m!=f&&b!=f)||(null===r&&(t=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))/.exec(window.navigator.userAgent),r=!!t&&(536>parseInt(t[1],10)||536===parseInt(t[1],10)&&11>=parseInt(t[2],10))),t=r&&(m==g&&b==g&&f==g||m==v&&b==v&&f==v||m==x&&b==x&&f==x)),t=!t),t&&(E.parentNode&&E.parentNode.removeChild(E),clearTimeout(h),e(o))}var l=new n(a),y=new n(a),w=new n(a),m=-1,b=-1,f=-1,g=-1,v=-1,x=-1,E=document.createElement("div");E.dir="ltr",i(l,u(o,"sans-serif")),i(y,u(o,"serif")),i(w,u(o,"monospace")),E.appendChild(l.a),E.appendChild(y.a),E.appendChild(w.a),document.body.appendChild(E),g=l.a.offsetWidth,v=y.a.offsetWidth,x=w.a.offsetWidth,function e(){if((new Date).getTime()-p>=c)E.parentNode&&E.parentNode.removeChild(E),t(Error(c+"ms timeout exceeded"));else{var n=document.hidden;!0!==n&&void 0!==n||(m=l.a.offsetWidth,b=y.a.offsetWidth,f=w.a.offsetWidth,d()),h=setTimeout(e,50)}}(),s(l,(function(e){m=e,d()})),i(l,u(o,'"'+o.family+'",sans-serif')),s(y,(function(e){b=e,d()})),i(y,u(o,'"'+o.family+'",serif')),s(w,(function(e){f=e,d()})),i(w,u(o,'"'+o.family+'",monospace'))}))}))},e.exports=a}()}},[[106,1,2,0]]]);
//# sourceMappingURL=main.4ae10bde828cbbb67c65.js.map